# 미국 대형주 2배 레버리지 ETF 자동매매 봇

## 프로젝트 개요
테슬라(TSLA), 엔비디아(NVDA) 등 미국 대형주 2배 레버리지 ETF를 대상으로 하는 자동매매 시스템

## 주요 기능
- **운용주기**: Daily (오후 5시 ~ 새벽 5시)
- **손익 기준**: 손절 -3%, 익절 +6~7%
- **기대수익**: 하루 1~3% 목표
- **포지션 관리**: 최대 1.5일 유지 (익일 오전 매도)
- **기술적 지표**: RSI/MACD 기반 매매 신호
- **자동 매도**: 조건형 트리거 (가격 기준)

## 프로젝트 구조
```
trading_bot/
├── config/
│   └── settings.py          # 설정 파일
├── data/
│   └── data_fetcher.py      # 데이터 수집 모듈
├── strategy/
│   └── indicators.py        # 기술적 지표 계산
│   └── signal_generator.py # 매매 신호 생성
├── trading/
│   └── trader.py            # 거래 실행 모듈
│   └── position_manager.py  # 포지션 관리
├── utils/
│   └── logger.py            # 로깅 유틸리티
│   └── scheduler.py         # 스케줄러
├── main.py                  # 메인 봇 실행 파일
├── test_bot.py              # 테스트 코드
└── requirements.txt         # 의존성 패키지
```

## 설치 방법
```bash
cd ~/trading_bot
pip install -r requirements.txt
```

## 설정
`config/settings.py`에서 API 키 및 거래 설정을 수정하세요.

## 실행 방법
```bash
# backtest
python reversal_backtest.py
# 테스트 모드
python test_bot.py

# 실제 거래 모드
python main.py
```

## 주의사항
- 실제 거래 전 반드시 모의 거래로 테스트하세요
- API 키는 안전하게 관리하세요
- 레버리지 거래는 고위험 투자입니다

## Result
``` bash
======================================================================
📊 전환 매매 전략 백테스트 결과
======================================================================

💰 자본 변화
  초기 자본:     $   12,000.00
  최종 자본:     $   11,972.62
  총 손익:       $     -27.38 ( -0.23%)

📈 거래 통계
  총 거래 횟수:            16회
  전환 매매 횟수:            1회
  승리 거래:                7회 ( 43.75%)
  손실 거래:                9회 ( 56.25%)
  평균 수익:     $       39.32
  평균 손실:     $      -33.62

======================================================================

🔄 전환 매매 내역:
----------------------------------------------------------------------
1. NVDX (LONG) -> NVDQ (SHORT)
   시간: 2025-12-02 20:24 | 가격: $15.39 | 이유: 손절 전환 (STOP_LOSS)

======================================================================


✅ 백테스트 완료!
   총 거래: 16회
   전환 매매: 1회
   최종 자본: $11,972.62
   총 손익: $-27.38

백테스트 완료
(base) chaehwan@chaehwan-900X5L:~/trading_bot$ python reversal_backtest.py~^C
(base) chaehwan@chaehwan-900X5L:~/trading_bot$ python reversal_backtest.py
2025-12-02 20:28:16 - trading_bot - INFO - 전환 매매 전략 초기화: {'symbol': 'TSLA', 'capital': 12000, 'stop_loss_rate': -0.07, 'take_profit_rate': 0.26, 'reverse_trigger': True, 'reverse_mode': 'full', 'reverse_delay': 10, 'reverse_risk_factor': 0.8, 'max_hold_days': 3, 'lookback_window': 10, 'volatility_threshold': 0.08, 'cooldown_period': 1, 'reversal_limit': 2, 'max_drawdown': 0.1, 'trailing_stop': True, 'reverse_confirmation': True, 'price_momentum': 0.02, 'volume_threshold': 1.5, 'market_sentiment_index': 0.0}

🚀 전환 매매 전략 백테스트 시작
   원본 주식: TSLA
   롱 ETF: TSLL
   숏 ETF: TSLZ
   기간: 2024-11-01 ~ 2025-11-29
   간격: 2m


======================================================================
전환 매매 전략 백테스트 시작
원본 주식: TSLA -> TSLL/TSLZ
기간: 2024-11-01 ~ 2025-11-29
초기 자본: $12000.00
======================================================================

데이터 수집 중...
✅ 데이터 수집 완료: 원본 5759개, 롱 5759개, 숏 5739개

📉 [2025-10-20 10:20] TSLA -> TSLZ 숏 진입 @ $13.67 x 42.19
2025-12-02 20:28:21 - trading_bot - INFO - 반전 지연: 10초 대기
2025-12-02 20:28:26 - trading_bot - INFO - 포지션 청산: TSLZ SHORT @ $15.45 (손익: -13.02%)
2025-12-02 20:28:26 - trading_bot - INFO - 🔄 전환 매매 실행: TSLL -> TSLL (LONG) @ $18.11 x 31.85
🔄 [2025-10-23 09:30] 전환 매매: TSLZ -> TSLL
🔒 [2025-11-03 09:52] TSLL LONG 청산 @ $22.83 (손익: 26.03%) - TAKE_PROFIT
📉 [2025-11-03 10:10] TSLA -> TSLZ 숏 진입 @ $11.93 x 48.38
2025-12-02 20:28:33 - trading_bot - INFO - 쿨다운 기간 중: 2025-12-03 20:28:26.849463
🔒 [2025-11-04 09:30] TSLZ SHORT 청산 @ $12.83 (손익: -7.55%) - STOP_LOSS
📈 [2025-11-04 09:52] TSLA -> TSLL 롱 진입 @ $21.51 x 26.82
2025-12-02 20:28:34 - trading_bot - INFO - 쿨다운 기간 중: 2025-12-03 20:28:26.849463
🔒 [2025-11-06 11:22] TSLL LONG 청산 @ $19.92 (손익: -7.41%) - STOP_LOSS
📈 [2025-11-06 12:04] TSLA -> TSLL 롱 진입 @ $19.97 x 28.89
2025-12-02 20:28:35 - trading_bot - INFO - 쿨다운 기간 중: 2025-12-03 20:28:26.849463
🔒 [2025-11-07 09:36] TSLL LONG 청산 @ $18.57 (손익: -7.02%) - STOP_LOSS
📈 [2025-11-07 09:58] TSLA -> TSLL 롱 진입 @ $19.10 x 30.21
2025-12-02 20:28:36 - trading_bot - INFO - 최대 보유 기간 초과: 3일
🔒 [2025-11-10 09:30] TSLL LONG 청산 @ $19.78 (손익: 3.56%) - FORCE_CLOSE
📈 [2025-11-10 09:34] TSLA -> TSLL 롱 진입 @ $19.34 x 29.83
2025-12-02 20:28:38 - trading_bot - INFO - 최대 보유 기간 초과: 3일
🔒 [2025-11-13 09:30] TSLL LONG 청산 @ $18.21 (손익: -5.83%) - FORCE_CLOSE
📈 [2025-11-13 10:20] TSLA -> TSLL 롱 진입 @ $17.32 x 33.32
2025-12-02 20:28:39 - trading_bot - INFO - 쿨다운 기간 중: 2025-12-03 20:28:26.849463
🔒 [2025-11-13 13:08] TSLL LONG 청산 @ $16.08 (손익: -7.13%) - STOP_LOSS
📉 [2025-11-14 09:34] TSLA -> TSLZ 숏 진입 @ $16.66 x 34.63
2025-12-02 20:28:40 - trading_bot - INFO - 최대 보유 기간 초과: 3일
🔒 [2025-11-17 09:30] TSLZ SHORT 청산 @ $15.61 (손익: 6.30%) - FORCE_CLOSE
📈 [2025-11-17 09:42] TSLA -> TSLL 롱 진입 @ $16.93 x 34.07
2025-12-02 20:28:42 - trading_bot - INFO - 최대 보유 기간 초과: 3일
🔒 [2025-11-20 09:30] TSLL LONG 청산 @ $17.60 (손익: 3.95%) - FORCE_CLOSE
📉 [2025-11-20 10:08] TSLA -> TSLZ 숏 진입 @ $13.99 x 41.24
2025-12-02 20:28:43 - trading_bot - INFO - 쿨다운 기간 중: 2025-12-03 20:28:26.849463
🔒 [2025-11-20 11:54] TSLZ SHORT 청산 @ $15.09 (손익: -7.86%) - STOP_LOSS
📈 [2025-11-20 12:28] TSLA -> TSLL 롱 진입 @ $16.52 x 34.92
2025-12-02 20:28:44 - trading_bot - INFO - 쿨다운 기간 중: 2025-12-03 20:28:26.849463
🔒 [2025-11-21 10:20] TSLL LONG 청산 @ $15.31 (손익: -7.35%) - STOP_LOSS
📉 [2025-11-21 10:26] TSLA -> TSLZ 숏 진입 @ $16.72 x 34.51
2025-12-02 20:28:44 - trading_bot - INFO - 최대 보유 기간 초과: 3일
🔒 [2025-11-24 09:30] TSLZ SHORT 청산 @ $15.20 (손익: 9.04%) - FORCE_CLOSE
📉 [2025-11-24 10:16] TSLA -> TSLZ 숏 진입 @ $14.57 x 39.60
2025-12-02 20:28:47 - trading_bot - INFO - 최대 보유 기간 초과: 4일
🔒 [2025-11-28 09:30] TSLZ SHORT 청산 @ $13.44 (손익: 7.76%) - FORCE_CLOSE

======================================================================
📊 전환 매매 전략 백테스트 결과
======================================================================

💰 자본 변화
  초기 자본:     $   12,000.00
  최종 자본:     $   11,962.32
  총 손익:       $     -37.68 ( -0.31%)

📈 거래 통계
  총 거래 횟수:            14회
  전환 매매 횟수:            1회
  승리 거래:                6회 ( 42.86%)
  손실 거래:                8회 ( 57.14%)
  평균 수익:     $       54.46
  평균 손실:     $      -45.56

======================================================================

🔄 전환 매매 내역:
----------------------------------------------------------------------
1. TSLZ (SHORT) -> TSLL (LONG)
   시간: 2025-12-02 20:28 | 가격: $18.11 | 이유: 손절 전환 (STOP_LOSS)

======================================================================


✅ 백테스트 완료!
   총 거래: 14회
   전환 매매: 1회
   최종 자본: $11,962.32
   총 손익: $-37.68


======================================================================
📊 전환 매매 전략 백테스트 결과
======================================================================

💰 자본 변화
  초기 자본:     $   12,000.00
  최종 자본:     $   11,972.62
  총 손익:       $     -27.38 ( -0.23%)

📈 거래 통계
  총 거래 횟수:            16회
  전환 매매 횟수:            1회
  승리 거래:                7회 ( 43.75%)
  손실 거래:                9회 ( 56.25%)
  평균 수익:     $       39.32
  평균 손실:     $      -33.62

======================================================================

🔄 전환 매매 내역:
----------------------------------------------------------------------
1. NVDX (LONG) -> NVDQ (SHORT)
   시간: 2025-12-02 20:24 | 가격: $15.39 | 이유: 손절 전환 (STOP_LOSS)

======================================================================


✅ 백테스트 완료!
   총 거래: 16회
   전환 매매: 1회
   최종 자본: $11,972.62
   총 손익: $-27.38
```
